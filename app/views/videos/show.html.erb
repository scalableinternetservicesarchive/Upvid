

<p>
  <strong>User:</strong>
  <%= @video.user.email %>
</p>

<p>
  <strong>Title:</strong>
  <%= @video.title %>
</p>

<p>
  <strong>Category:</strong>
  <%= @video.category %>
</p>

<video src=<%= stream_path(@video) %> controls width = 500></video>
<br>
<%if @video.user == current_user%>
  <td><%= link_to 'Edit', edit_video_path(@video) %></td>
  <td><%= link_to 'Destroy', @video, method: :delete, data: { confirm: 'Are you sure?' } %></td>
<%end%>

<% if current_user %>
  <% if current_user.favorites.include?(@video) %>
    <%= link_to 'Unfavorite', favorite_video_path(@video, type: "unfavorite"), method: :put, :class => "btn btn-danger" %>
  <% else %>
    <%= link_to 'Favorite',   favorite_video_path(@video, type: "favorite"), method: :put, :class => "btn btn-warning" %>
  <% end %>
<% end %>

<div>
    <%= render 'comments/form', :locals => {:video => @video}%>
</div>

<% @video.comments.reverse.each do |comment| %>
  <% t = Time.now - comment.created_at 
     mm, ss = t.divmod(60)
     hh, mm = mm.divmod(60)
     dd, hh = hh.divmod(24)

     s = ""

     if (dd!=0)
      s+="%d days, " % [dd]
     end

     if (hh!=0)
      s+="%d hours, " % [hh]
     end

     if (mm!=0)
      s += "%d minutes" % [mm]
     end

     if (s=="")
      s = "%d seconds" % [ss]
     else
      s += " and %d seconds" % [ss]
     end
  %>
  <b><%= comment.user.email %> <%= s %> ago</b><br>
    <%= comment.message %><br><br>
<%end %>
